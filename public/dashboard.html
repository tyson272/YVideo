<script>
async function loadMedia() {
  const res = await fetch('/media');
  if (!res.ok) {
    location.href = '/login.html';
    return;
  }

  const albums = await res.json();
  const container = document.getElementById('videos');
  container.innerHTML = '';

  albums.forEach(a => {
    const section = document.createElement('div');
    section.innerHTML = `<h2 class="text-xl mb-4">${a.album}</h2>`;
    section.className = 'mb-8';

    const grid = document.createElement('div');
    grid.className = 'grid grid-cols-1 md:grid-cols-3 gap-4';

    a.files.forEach(f => {
      let el;
      if (f.match(/\.(mp4|webm|ogg)$/)) {
        el = document.createElement('video');
        el.controls = true;
      } else {
        el = document.createElement('img');
      }
      el.src = `/media/${a.album}/${encodeURIComponent(f)}`;
      el.className = 'rounded-lg w-full';

      grid.appendChild(el);
    });

    section.appendChild(grid);
    container.appendChild(section);
  });
}

loadMedia();
</script>
