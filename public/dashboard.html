<!DOCTYPE html>
<html>
<head>
  <title>Gallery</title>
  <link rel="stylesheet" href="style.css">
</head>
<body oncontextmenu="return false">

<div class="container">
  <div class="top-bar">
    <h1>Gallery</h1>
    <a href="/logout">Logout</a>
  </div>

  <div id="gallery"></div>
</div>

<script>
async function loadGallery() {
  const res = await fetch('/media');
  if (!res.ok) {
    location.href = '/login.html';
    return;
  }

  const albums = await res.json();
  const container = document.getElementById('gallery');

  albums.forEach(a => {
    const section = document.createElement('div');
    section.className = 'album';

    section.innerHTML = `<div class="album-title">${a.album}</div>`;

    const grid = document.createElement('div');
    grid.className = 'grid';

    a.files.forEach(f => {
      const card = document.createElement('div');
      card.className = 'card';

      if (f.match(/\.(mp4|webm)$/)) {
        card.innerHTML = `
          <video src="/media/${a.album}/${f}" controls controlsList="nodownload"></video>
        `;
      } else {
        card.innerHTML = `
          <img src="/media/${a.album}/${f}" draggable="false" />
        `;
      }

      grid.appendChild(card);
    });

    section.appendChild(grid);
    container.appendChild(section);
  });
}

loadGallery();
</script>
</body>
</html>
