<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Dashboard â€“ YVideo</title>
</head>
<body>
  <h2>Video Library</h2>
  <a href="/logout">Logout</a>

  <hr />
  <div id="status">Loading videos...</div>
  <div id="videos"></div>

  <script>
    async function loadVideos() {
      const status = document.getElementById('status');
      const container = document.getElementById('videos');

      const res = await fetch('/videos');
      if (!res.ok) {
        location.href = '/login.html';
        return;
      }

      const videos = await res.json();
      container.innerHTML = '';

      if (!videos.length) {
        status.textContent = 'No videos available';
        return;
      }

      status.textContent = '';

      videos.forEach(v => {
        const video = document.createElement('video');
        video.src = `/stream/${encodeURIComponent(v.name)}`;
        video.controls = true;
        video.style.display = 'block';
        video.style.marginBottom = '20px';
        container.appendChild(video);
      });
    }

    loadVideos();
  </script>
</body>
</html>
